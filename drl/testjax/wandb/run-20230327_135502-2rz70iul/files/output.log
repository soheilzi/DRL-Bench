Epoch:  0 Test Accuracy:  0.763
Epoch:  0 Train Accuracy:  0.78125
Epoch:  1 Test Accuracy:  0.814
Epoch:  1 Train Accuracy:  0.84375
Epoch:  2 Test Accuracy:  0.83300006
Epoch:  2 Train Accuracy:  0.84375
Epoch:  3 Test Accuracy:  0.83900005
Epoch:  3 Train Accuracy:  0.875
Epoch:  4 Test Accuracy:  0.84800005
Epoch:  4 Train Accuracy:  0.90625
Epoch:  5 Test Accuracy:  0.85400003
Epoch:  5 Train Accuracy:  0.90625
Epoch:  6 Test Accuracy:  0.84800005
Epoch:  6 Train Accuracy:  0.9375
Epoch:  7 Test Accuracy:  0.84200007
Epoch:  7 Train Accuracy:  0.96875
Epoch:  8 Test Accuracy:  0.84300005
Epoch:  8 Train Accuracy:  0.96875
Epoch:  9 Test Accuracy:  0.846
Epoch:  9 Train Accuracy:  0.96875
Epoch:  10 Test Accuracy:  0.85300004
Epoch:  10 Train Accuracy:  1.0
Epoch:  11 Test Accuracy:  0.85600007
Epoch:  11 Train Accuracy:  0.96875
Epoch:  12 Test Accuracy:  0.855
Epoch:  12 Train Accuracy:  0.9375
Epoch:  13 Test Accuracy:  0.85600007
Epoch:  13 Train Accuracy:  0.9375
Epoch:  14 Test Accuracy:  0.85200006
Epoch:  14 Train Accuracy:  0.9375
Epoch:  15 Test Accuracy:  0.851
Epoch:  15 Train Accuracy:  0.9375
Epoch:  16 Test Accuracy:  0.851
Epoch:  16 Train Accuracy:  0.9375
Epoch:  17 Test Accuracy:  0.84000003
Epoch:  17 Train Accuracy:  0.96875
Epoch:  18 Test Accuracy:  0.841
Epoch:  18 Train Accuracy:  0.96875
Epoch:  19 Test Accuracy:  0.841
Epoch:  19 Train Accuracy:  0.96875
Epoch:  20 Test Accuracy:  0.84300005
Epoch:  20 Train Accuracy:  1.0
Epoch:  21 Test Accuracy:  0.85200006
Epoch:  21 Train Accuracy:  0.96875
Epoch:  22 Test Accuracy:  0.85600007
Epoch:  22 Train Accuracy:  1.0
Epoch:  23 Test Accuracy:  0.864
Epoch:  23 Train Accuracy:  1.0
Epoch:  24 Test Accuracy:  0.86700004
Epoch:  24 Train Accuracy:  1.0
Epoch:  25 Test Accuracy:  0.869
Epoch:  25 Train Accuracy:  1.0
Epoch:  26 Test Accuracy:  0.86600006
Epoch:  26 Train Accuracy:  1.0
Epoch:  27 Test Accuracy:  0.86
Epoch:  27 Train Accuracy:  1.0
Epoch:  28 Test Accuracy:  0.86200005
Epoch:  28 Train Accuracy:  1.0
Epoch:  29 Test Accuracy:  0.86100006
Epoch:  29 Train Accuracy:  1.0
Epoch:  30 Test Accuracy:  0.86
Epoch:  30 Train Accuracy:  1.0
Epoch:  31 Test Accuracy:  0.86300004
Epoch:  31 Train Accuracy:  0.96875
Epoch:  32 Test Accuracy:  0.855
Epoch:  32 Train Accuracy:  1.0
Epoch:  33 Test Accuracy:  0.85800004
Epoch:  33 Train Accuracy:  0.96875
Epoch:  34 Test Accuracy:  0.85200006
Epoch:  34 Train Accuracy:  1.0
Epoch:  35 Test Accuracy:  0.851
Epoch:  35 Train Accuracy:  1.0
Epoch:  36 Test Accuracy:  0.846
Epoch:  36 Train Accuracy:  1.0
Epoch:  37 Test Accuracy:  0.84000003
Epoch:  37 Train Accuracy:  0.96875
Epoch:  38 Test Accuracy:  0.846
Epoch:  38 Train Accuracy:  1.0
Epoch:  39 Test Accuracy:  0.84300005
Epoch:  39 Train Accuracy:  0.96875
Epoch:  40 Test Accuracy:  0.85600007
Epoch:  40 Train Accuracy:  1.0
Epoch:  41 Test Accuracy:  0.86
Epoch:  41 Train Accuracy:  1.0
Epoch:  42 Test Accuracy:  0.85300004
Epoch:  42 Train Accuracy:  1.0
Epoch:  43 Test Accuracy:  0.85600007
Epoch:  43 Train Accuracy:  1.0
Epoch:  44 Test Accuracy:  0.86600006
Epoch:  44 Train Accuracy:  1.0
Epoch:  45 Test Accuracy:  0.86800003
Epoch:  45 Train Accuracy:  1.0
Epoch:  46 Test Accuracy:  0.869
Epoch:  46 Train Accuracy:  1.0
Epoch:  47 Test Accuracy:  0.87000006
Epoch:  47 Train Accuracy:  1.0
Epoch:  48 Test Accuracy:  0.87500006
Epoch:  48 Train Accuracy:  1.0
Epoch:  49 Test Accuracy:  0.878
Epoch:  49 Train Accuracy:  1.0
Epoch:  50 Test Accuracy:  0.873
Epoch:  50 Train Accuracy:  1.0
Epoch:  51 Test Accuracy:  0.87000006
Epoch:  51 Train Accuracy:  1.0
Epoch:  52 Test Accuracy:  0.873
Epoch:  52 Train Accuracy:  1.0
Epoch:  53 Test Accuracy:  0.87000006
Epoch:  53 Train Accuracy:  1.0
Epoch:  54 Test Accuracy:  0.87100005
Epoch:  54 Train Accuracy:  1.0
Epoch:  55 Test Accuracy:  0.869
Epoch:  55 Train Accuracy:  1.0
Epoch:  56 Test Accuracy:  0.87000006
Epoch:  56 Train Accuracy:  1.0
Epoch:  57 Test Accuracy:  0.87000006
Epoch:  57 Train Accuracy:  1.0
Epoch:  58 Test Accuracy:  0.869
Epoch:  58 Train Accuracy:  1.0
Epoch:  59 Test Accuracy:  0.87100005
Epoch:  59 Train Accuracy:  1.0
Epoch:  60 Test Accuracy:  0.873
Epoch:  60 Train Accuracy:  1.0
Epoch:  61 Test Accuracy:  0.874
Epoch:  61 Train Accuracy:  1.0
Epoch:  62 Test Accuracy:  0.87500006
Epoch:  62 Train Accuracy:  1.0
Epoch:  63 Test Accuracy:  0.878
Epoch:  63 Train Accuracy:  1.0
Traceback (most recent call last):
  File "/home/soheil/DRL-Bench/drl/testjax/mnist-test.py", line 118, in <module>
    grads = jax.grad(loss)(params, batch, batch_labels)
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/api.py", line 1179, in grad_f
    _, g = value_and_grad_f(*args, **kwargs)
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/api.py", line 1255, in value_and_grad_f
    ans, vjp_py = _vjp(f_partial, *dyn_args, reduce_axes=reduce_axes)
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/api.py", line 2804, in _vjp
    out_primal, out_vjp = ad.vjp(
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/interpreters/ad.py", line 139, in vjp
    out_primals, pvals, jaxpr, consts = linearize(traceable, *primals)
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/interpreters/ad.py", line 128, in linearize
    jaxpr, out_pvals, consts = pe.trace_to_jaxpr_nounits(jvpfun_flat, in_pvals)
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/interpreters/partial_eval.py", line 772, in trace_to_jaxpr_nounits
    jaxpr, (out_pvals, consts, env) = fun.call_wrapped(pvals)
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/linear_util.py", line 165, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/soheil/DRL-Bench/drl/testjax/mnist-test.py", line 87, in loss
    return -jnp.mean(jnp.sum(y * jnp.log(y_pred), axis=1))
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/numpy/reductions.py", line 222, in sum
    return _reduce_sum(a, axis=_ensure_optional_axes(axis), dtype=dtype, out=out,
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/pjit.py", line 235, in cache_miss
    outs, out_flat, out_tree, args_flat = _python_pjit_helper(
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/pjit.py", line 179, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _ = infer_params_fn(
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/api.py", line 442, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/pjit.py", line 459, in common_infer_params
    f, dyn_kwargs = argnames_partial_except(f, static_argnames, kwargs)
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/api_util.py", line 347, in argnames_partial_except
    return _argnames_partial(f, WrapKwArgs(fixed_kwargs)), dyn_kwargs
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/linear_util.py", line 216, in transformation
    return fun.wrap(gen, gen_static_args, None)
  File "/home/soheil/miniconda3/envs/bench/lib/python3.10/site-packages/jax/_src/linear_util.py", line 142, in wrap
    return WrappedFun(self.f, ((gen, gen_static_args),) + self.transforms,
KeyboardInterrupt